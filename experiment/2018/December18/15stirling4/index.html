<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
  <link rel="stylesheet" type="text/css" href="../../../libs/mathBlogStyle.css">

  <script type="text/javascript" src="../../../libs/jquery_3.4.1.js"></script>
  <script type="text/javascript" src="../../../libs/menu.js"></script>
  <script type="text/javascript" src="../../../config.js"></script> 
  <script type="text/javascript" src="../../../libs/mathBlogBase.js"></script> 
  <script type="text/x-mathjax-config">
    configureMathJax();
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script>  
</head>

<body>
  <div id="menu"></div>

  <div class="mainText">
    <div class="article">
      

    <h3>Stirling formula</h3>
<tt> 15 December 2018</tt>
<br>
<i> it is more than 40 years ago that I learned the Stirling formula
using the stationary phase method. It is today that I realised,
that I did a mistake in calculations.</i>
<br>
<br>
Stirling formula is an excellent example of applying stationary phase 
method:
     Consider
     $$
     \Gamma(x)=\int_0^\infty t^{x-1}e^{-t}tdt\,,\quad n!=\Gamma(n+1)\,.
     $$
We have
    $$
N!=\Gamma(N+1)=
\int_0^\infty\exp [-t+N\log t]dt=
    N
\int_0^\infty\exp [-Nx+N\log Nx]dx=
     $$
     $$
N^{N+1}\int_0^\infty \exp {F(x)}dx\,,\quad {\rm where}\,\,
    F(x)=N\log x-Nx
    \tag{1}
    $$
Then consider Taylor series expansion of the function $F(x)$
in the vicinity of the stationary point $x_0=1$
        $$
  F(x)=
  F(x_0)+F'(x_0)(x-x_0)+
   {1\over 2}F^{''}(x_0)(x-x_0)^2+
   {1\over 6}F^{'''}(x_0)(x-x_0)^3+
   {1\over 24}F^{''''}(x_0)(x-x_0)^4+
\dots=
            $$
          $$
  -N-{N\over 2}(x-1)^2+{N\over 3}(x-1)^3-
  {N\over 4}(x-1)^4+
\dots
       =
      $$ 
and
       $$
N!=
N^{N+1}\int_0^\infty \exp [F(t)]dt=
N^{N+1}\int_0^\infty \exp 
         \left[
  -N-{N\over 2}(x-1)^2+{N\over 3}(x-1)^3-
  {N\over 4}(x-1)^4+
\dots
       \right]dx
       $$
<tt> Zeroth approximmation</tt>
 $$
N!
=
N^{N+1}\int_0^\infty \exp 
         \left[
        -N
       +\dots\right]dx
     \approx N\left(N\over e\right)^N\,,
       $$
<tt> First  approximmation</tt>
 $$
N!
=
N^{N+1}\int_0^\infty \exp 
         \left[
  -N
   -{N\over 2}(x-1)^2
       +\dots\right]dx
        =
        $$
        $$
   N\left(N\over e\right)^N\int_{-1}^\infty e^{-{Ny^2\over 2}}dy=
   N\left(N\over e\right)^N{1\over \sqrt N}
    \int_{-\sqrt N}^\infty 
  e^{-{u^2\over 2}}du\approx
         $$
           $$
   N\left(N\over e\right)^N{1\over \sqrt N}
    \int_{-\infty}^\infty 
  e^{-{u^2\over 2}}du=
   \sqrt {2\pi N}\left(N\over e\right)^N\,.
           $$
 <tt> Second apprximation</tt>
        $$
 N!=
         N^{N+1}
\int_0^\infty \exp [F(t)]dt
=
       N^{N+1}
\int_0^\infty \exp 
         \left[
  -N-
   {N\over 2}(x-1)^2+
   {N\over 3}(x-1)^3-
     \dots
       \right]dx=
       $$
     $$
N\left(N\over e\right)^N
     \int_0^\infty
    \exp
  \left[
      -{N\over 2}(x-1)^2
      +{N\over 3}(x-1)^3+\dots
      \right]=
        $$
        $$
 N\left(N\over e\right)^N
          {1\over \sqrt N}
     \int_{-\sqrt N}^\infty
       e^{-{u^2\over 2}}
    \exp
  \left[
      {1\over 3\sqrt N}u^3+\dots
      \right]du\approx
\sqrt {2\pi N}\left(N\over e\right)^N\,,
      $$
since $\int_{-\infty}^\infty e^{-{u^2\over 2}}u^3du=0$.
<br>
 <tt> Third apprximation</tt>
        $$
 N!=
         N^{N+1}
\int_0^\infty \exp [F(t)]dt
=
       N^{N+1}
\int_0^\infty \exp 
         \left[
  -N-
   {N\over 2}(x-1)^2+
   {N\over 3}(x-1)^3-
   {N\over 4}(x-1)^4+
     \dots
       \right]dx=
       $$
     $$
N\left(N\over e\right)^N
     \int_0^\infty
    \exp
  \left[
      -{N\over 2}(x-1)^2
      +{N\over 3}(x-1)^3
      -{N\over 4}(x-1)^4+
       \dots
      \right]dx=
        $$
  $$
 N\left(N\over e\right)^N
     {1\over \sqrt N}
     \int_{-\sqrt N}^\infty
       e^{-{u^2\over 2}}
    \exp
  \left[
      {1\over 3\sqrt N}u^3-
      {1\over 4 N}u^4+
            \dots
      \right]du
          $$
           $$
        \approx
 \sqrt N\left(N\over e\right)^N
     \int_{-\infty}^\infty
       e^{-{u^2\over 2}}
  \left[
         1+
      {1\over 3\sqrt N}u^3-
      {1\over 4 N}u^4+
            \dots
      \right]du
         \approx
       $$
         $$
 \sqrt N\left(N\over e\right)^N
        \left[
         \sqrt {2\pi}+
     \int_{-\infty}^\infty
       e^{-{u^2\over 2}}
              \left(
      {1\over 3\sqrt N}u^3-
      {1\over 4 N}u^4
            \right)du
      \right]=
         $$
         $$
 \sqrt {2\pi N}\left(N\over e\right)^N
        \left[
         1-
            {1\over 4N}
     \int_{-\infty}^\infty
             u^4
       e^{-{u^2\over 2}}
           du
      \right]=
         $$
</div>
  </div>
 </body>
</html>