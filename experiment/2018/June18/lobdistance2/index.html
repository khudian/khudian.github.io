<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
  <link rel="stylesheet" type="text/css" href="../../../mathBlogStyle.css">

  <script type="text/javascript" src="../../../jquery_3.4.1.js"></script>
  <script type="text/javascript" src="../../../menu.js"></script> 
  <script type="text/javascript" src="../../../mathBlogMain.js"></script> 
  <script type="text/x-mathjax-config">
    configureMathJax();
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script>  
</head>

<body>
  <div id="menu"></div>

  <div class="mainText">
    <div class="article">
      <h2 class="title" date=""></h2>

end of  June 2018
<br>
\centerline  {\bf Distance in Lobachevsky geometry}
<br>
          \centerline {${\S}\,0$}
<br>
Let $z=x_1+ix_2,w=x_2+iy_2$ be two points 
in the upper half plane of the complex 
plane $\C $, ($y_1,y_2>0$.) 
In this etude-exercise  we will derive 
explicitl formula for  the hyperbolic distance
between arbitrary two  points:
       $$
d(z,w)={\rm arccosh\,}\left(
 1+{(x_2-x_1)^2+(y_2-y_1)^2\over 2y_1y_2}
     \right)\,.
        \tag{0.0}
       $$
<br>
   Recall that upper half plane of $\C$ with metric
       $$
      G={dx^2+dy^2\over y^2}
\tag{0.1}
       $$
is a model of Lobachevsky plane.
<br>
Geodesics in this model are vertical lines and
upper half-circles with centre on the  axis $OX$.
<br>
In the special case if
the points $A,B$ are on the same vertical line,  
$A=z=x_1+iy_1$ and $B=w=x_2+iy_2$ with  $x_1=x_2$
then one can easy to calculate
the distance $=$ length of the arc of geodesic 
(segment of vertical line
): $\cases {x(t)=x_1\cr y(t)=t\cr}, y_1<t<y_2$c 
between these points:
         $$
   d(z,w)\big\vert_{x_1=x_2}=
   \int_{t_1}^{t_2} 
\sqrt{x_t^2+y_t^2\over y^2(t)}dt=
   \int_{t_1}^{t_2}{dt\over t}=
\left|\log{y_1\over y_2}\right|\,, 
       \tag{0.2}  
       $$ 
(Compare with (0.0)).
<br>
In the general case if points  $z,w$ 
have not the same ordinate, then the arc of geodesic
between these points is the arc of the 
circle  with centre
on the $OX$ axis passing trough these points:
             $$
     \cases
   {
   x(\varphi)=a+R\cos\varphi\cr
   y(\varphi)=R\sin\varphi\cr
   }, \qquad 
\varphi_1\leq \varphi\leq \varphi_2
              $$
and
       $$
   d(z,w)\big\vert_{x_1\not= x_2}=
   \int_{\varphi_1}^{\varphi_2} 
\sqrt{x_t^2+y_t^2\over y^2(t)}dt=
 \int_{\varphi_1}
 ^{\varphi_2}{d\varphi\over \sin\varphi}=\log \tan {\varphi\over 2}
\big\vert^{\varphi_2}_{\varphi_1}=
 \left|
  \log
    \left(
{\tan{\varphi_1\over 2}\over\tan{\varphi_1\over 2} }
    \right)\right|
    \tag{0.3}
      $$
One can write the
 explicit formula for arbitrary points   using
<br>
\m
<br>
a) equation (0.3): One has to express  `polar coordinates'
in terms of Cartesian
<br>
\m
<br>
b)  using formula (0.1) and invariance of distance
with respect to Mobius transformations
<br>
\m
c)  express the length in terms of cross-ratio,
which is Mobius invariant.
<br>
In the first paragraph we will come to formula (0.0)
using the invariance of distance.
<br>
Then we will suggest another  calculation using the explicit
expression (0.3) and at the end we will consider the calculation
using cross-ratio.
<br>
\bigskip
<br>
\centerline {${\S}\, 1$\bf Calculation using invariance}
<br>
First we consider the case if a point $B=w=i$.
Mobius  Transformation
      $$
  z\mapsto {z+a\over 1-az}\,,,  a\in \R
      $$ 
preserves the point $w=i$.   Find a parameter $a$ such that 
this transformation  transforms the point $z$ to the point
$z'=iy'$. Then formula (0.2) implies that 
          $$
d(z,w)=d(z,i)=d(z',i)=\left|\log|z'|\right|\,. 
          $$
Find the required   parameter $a$: we have to find $a$ such that 
        $
    z'={z+a\over 1-az} 
        $  is also on $OY$ axis, i.e.
         $$
a\colon \,, {\rm Re\,}{z+a\over 1-az}=0\,,
         $$
i.e.
            $$
   {z+a\over 1-az}+
   {\bar z+a\over 1-a z}=
   {(z+a)(1-a\bar z)+
   (\bar z+a)(1-a z)
       \over
   (1-az(1-a\bar z)
       }=0\,.
      $$
We come to the quadratic equation  on $a$
      $$
   (z+a)(1-a\bar z)+
   (\bar z+a)(1-a z)=(z+\bar z)+2a(1-z\bar z)-a^2(z+\bar z)=0
         $$
 which defines Mobius transformation which put two points
on the axis  $0Y$, provided the first point $w=i$.  
Solving this equation we come to
      $$
a={1-z\bar z\pm\sqrt {(1-z\bar z)^2+(z+\bar z)^2}\over z+\bar z}\,
={1-z\bar z\pm\sqrt {1+|z|^4+z^2+\bar z^2}\over z+\bar z}\,
      $$
i.e.   
       $$
  z'=iy'={z+a\over 1-az}
  ={z+{1-z\bar z+\sqrt {1+|z|^4+z^2+\bar z^2}\over z+\bar z}
   \over 1-{1-z\bar z+\sqrt {1+|z|^4+z^2+\bar z^2}
       \over z+\bar z}z}=
        $$
           $$
   {1+z^2+\sqrt {1+|z|^4+z^2+\bar z^2}
         \over
      \bar z(1+z^2)-z\sqrt {1+|z|^4+z^2+\bar z^2}}
=   {1+z^2+\sqrt {1+|z|^4+z^2+\bar z^2}
         \over
      \bar z-z\left(\sqrt {1+|z|^4+z^2+\bar z^2}-|z|^2\right)}
      \tag{1.1}
       $$
transforms an arbitrary point $z=x+iy$  with $y\not =0$
to the point on the axis $OY$.
(we choose the root with $'+'$, the second root is for the points
on $OX$ but we are not interested in these points.)
<br>
In Cartesian coordinates we have
       $$
z'=iy'={1+x^2-y^2+S(x,y)+2xyi\over 
x(1+x^2+y^2-S(x,y))-iy(1+S(x,y)-x^2-y^2)}\,,
           (1.2)
       $$
where we denote 
     $$
           S(x,y)=
   \sqrt {1+(x^2+y^2)^2+2x^2-2y^2}\,.
        \tag{1.3}
        $$
The choice of the parameter $a$ above provides that $z'$
in equation (1.3) is on $OY$ axis, i.e.
           $$
(1+x^2-y^2+S+2ixy)(1+x^2+y^2-S)=2xy^2(1+S-x^2-y^2)\,.
           $$
<br>
Now we ``play'' with formula (1.2).
Use the following simple fact:
<br>
{\tt Fact}
If $z'=iy'={a+bi\over c-di}$, i.e.   $ac=bd$, then
       $$
z'=iy'={a+bi\over c-di}={i(b-ia)\over c-di}=i{b\over c}=i{a\over d}
    \tag{1.4}
       $$
<br>
According to this identity return to formula (1.2):
             $$
z'=iy'= {1+z^2+\sqrt {1+|z|^4+z^2+\bar z^2}
         \over
      \bar z-z\left(\sqrt {1+|z|^4+z^2+\bar z^2}-|z|^2\right)}=
             $$
         $$
          {         
          {\overbrace{(1+x^2-y^2+S)}^a}
         +{\overbrace {2xy}^b}i
       \over
     {\underbrace {x(1+x^2+y^2-S)}_c} 
         -i
     {\underbrace {y(1+S-x^2-y^2)}_d}
         }=
     {1+x^2-y^2+S\over y(1-x^2-y^2+S)}i=
     {2y\over 1+x^2+y^2-S}i\,,
         $$
<br>
We see that
            $$
y'=
     {1+x^2-y^2+S\over y(1-x^2-y^2+S)}=
     {1+x^2-y^2+\sqrt {(1+x^2-y^2)^2+4x^2y^2}
      \over y\left(
      1-x^2-y^2+\sqrt {(1-x^2-y^2)^2+4x^2}
        \right)}=
            $$
   $$
     {2xy
       \left(
       \left({1+x^2-y^2\over 2xy}\right)+
    \sqrt {\left({1+x^2-y^2\over 2xy}\right)^2+1}
        \right)
      \over 2xy\left(
      \left({1-x^2-y^2\over 2x}\right)+
    \sqrt {\left({1-x^2-y^2\over 2x}\right)^2+1}
        \right)}=
                e^{
    {\rm arcsh\,}{1+x^2-y^2\over 2xy}
              -
    {\rm arcsh\,}{1-x^2-y^2\over 2x}
          }
\tag{1.5}
           $$
<br>
Note that
        $$
   ch\left(  a
              -
    b
\right)=\sqrt{1+a^2}\sqrt {1+b^2}-ab
         $$
i.e.
        $$
   ch\left(  {\rm arcsh\,}{1+x^2-y^2\over 2xy}
              -
    {\rm arcsh\,}{1-x^2-y^2\over 2x}
\right)=
          $$
          $$
\sqrt{1+\left({1+x^2-y^2\over 2xy}\right)^2}
\sqrt{1+\left({1-x^2-y^2\over 2x}\right)^2}
        -
{1+x^2-y^2\over 2xy}
{1-x^2-y^2\over 2x}=
     $$
     $$
{S^2(x,y)-(1+x^2-y^2)(1-x^2-y^2)\over 2x^2y}=
{1+(x^2+y^2)^2+2x^2-2y^2-(1-y^2)^2+x^4\over 2x^2y}=
     $$
<br>
        $$
{x^2+y^2+1\over 2y}\,.
         $$
Hence we see that in equation (1.5)
          $$
\log y'=
    {\rm arcsh\,}{1+x^2-y^2\over 2xy}
              -
    {\rm arcsh\,}{1-x^2-y^2\over 2x}
        = 
{\rm arccosh\,} \left(x^2+y^2+1\over 2y\right)\,.
          $$
Now using invariance of the distance with respect to
translations 
$\cases{x\mapsto x+a\cr y\mapsto y}$
and dilations
$\cases{x\mapsto \lambda x\cr y\mapsto \lambda y}$
we come to the final formula:
        $$
 `a  d(z,w)=d(x_1+iy_1,x_2+iy_2)=
     d\left(x_1-x_2+iy_1, iy_2\right)=
     d\left({x_1-x_2+iy_1\over y_2}, i\right)=
        $$
       $$
  {\rm arccosh}\left({x^2+y^2+1\over 2y}\right)
\big\vert_{x\mapsto {x_1-x_2\over y_2}, y\mapsto {y_1\over y_2}}=
{\rm arccosh}\left({\left({x_1-x_2\over y_2}\right)^2
    +\left({y_1\over y_2}\right)^2+1\over 
2\left({y_1\over y_2}\right)}\right)=
       $$
     $$
{\rm arccosh}\left({\left(x_1-x_2\right)^2
    +y_1^2+y_2^2\over 
2y_1y_2}\right)=
{\rm arccosh}\left(1+{\left(x_1-x_2\right)^2
    +(y_1-y_2)^2\over 
2y_1y_2}\right)\,.
       $$
This is just what we wanted (see (0.0)).
<br>
We calculated using invariance properties,
but our calculations still are brute force calculations.
Try to do it in another way:
\bigskip
<br>
\centerline {${\S}\, 2\,$
\bf Straightforward calculations using formula (0.2)}
Let $A=z_1=x_1+iy_1$,
$B=z_2=x_2+iy_2$ be two points. 
  To use equation (0.2) we have to calculate
parameters  $a,R,\varphi_1,\varphi_2$.
If 
   $z_A=x_1+iy_1$,
   $z_B=x_2+iy_2$,
   then arc of geodesic is
     $(x-a)^2+y^2=R^2$ and solving equation
        $$
  (x_1-a)^2+y_1^2=
  (x_2-a)^2+y_2^2
        $$
we come to
          $$
     a={x_1+x_2\over 2}+
     {y_1^2-y_2^2\over 2(x_1-x_2)}\,,\,
{\rm and}\quad
     R=\sqrt{(x-a)^2+y^2}=
           $$
           $$
      \sqrt
         {
      \left(
x_1-{x_1+x_2\over 2}-
     {y_1^2-y_2^2\over 2(x_1-x_2)}
       \right)^2+y_1^2
}
       =
      \sqrt
            {
             {
   (x_1-x_2)^2\over 4
           }+
      {(y_1^2-y_2^2)^2\over 4(x_1-x_2)^2}
          +{y_1^2+y_2^2\over 2}
            }\,,
    \tag{2.1}
          $$
Thus we can calculate $\varphi_1,\varphi_2$ and we will come to
the formula for the distance....
<br>
\bigskip
<br>
\centerline {${\S}\, 3\,$
\bf Cross-ratio and distance}
<br>
  For two arbitrary points $A,B$, 
the distance is the length of 
of the arc of geodesic 
(the half-circle with centre on $OX$ axis) passing
through these points.
<br>
   Consider points
$P_\infty, Q_{0}$ such that these points
are ending  and beginning  points
of the half-circle  
(the half-circle with centre on $OX$ axis) passing
through these points.
it is easy to see that formula
                  $$
d(z,w)=           \left|
             \log 
                  \left(
        A,B,P_{\infty}, Q_{0}
                \right)
               \right|
=           \left|\log 
               \left(
          \left(z_A-z_{P_{\infty}}\right)
         \left(z_B-z_{Q_{0}}\right)\right|
            \over
          \left(z_A-z_{Q_{0}}\right)
         \left(z_B-z_{P_{\infty}}\right)\right|
             \tag{3.1}
          $$
really defines the hyperbolic length. Indeed it is obviously invariant
with respect to Mobius transformations, and in the case
if points $A,B$ have the same $x$-coordinate, this formula  is
coincided with  equation (0.2):
         $$
z_A=x_1+iy_1, z_B=x_2+iy_2, x_1,=x_2\Rightarrow P_{\infty}=\infty, 
Q_{0}=0\,
         $$
and  equation (2.1) is reduced to
        $$
l=               
                  \left|
                  \log 
                  \left(
        A,B,\infty, 0
                \right)
               \right|
                  =           
             \left|
                \log 
               \left(
          \left(z_A-\infty\right)
         \left(z_B-0\right)
            \over
          \left(z_A-0\right)
         \left(z_B-\infty\right)
                  \right)
            \right|
        =\left|
       \log {y_2\over y_1}
        \right|\,.
       $$
<br>
To  perform the calculations in equation (2.1)
we have to use calculations (2.1) in the previous paragraph.
<br>
If 
   $z_A=x_1+iy_1$,
   $z_B=x_2+iy_2$,
   then arc of geodesic is
     $(x-a)^2+y^2=R^2$ and solving equation
        $$
  (x_1-a)^2+y_1^2=
  (x_2-a)^2+y_2^2
        $$
we come to
          $$
     a={x_1+x_2\over 2}+
     {y_1^2-y_2^2\over 2(x_1-x_2)}\,,\,
{\rm and}\quad
     R=\sqrt{(x-a)^2+y^2}=
           $$
           $$
      \sqrt
         {
      \left(
x_1-{x_1+x_2\over 2}-
     {y_1^2-y_2^2\over 2(x_1-x_2)}
       \right)^2+y_1^2
}
       =
      \sqrt
            {
             {
   (x_1-x_2)^2\over 4
           }+
      {(y_1^2-y_2^2)^2\over 4(x_1-x_2)^2}
          +{y_1^2+y_2^2\over 2}
            }\,,
          $$
and
        $$
P_\infty=a-R, \,,  Q_0=a+R\,.
       $$
<br>
</div>
  </div>
 </body>
</html>