<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
  <link rel="stylesheet" type="text/css" href="../../../libs/mathBlogStyle.css">

  <script type="text/javascript" src="../../../libs/jquery_3.4.1.js"></script>
  <script type="text/javascript" src="../../../libs/menu.js"></script>
  <script type="text/javascript" src="../../../config.js"></script> 
  <script type="text/javascript" src="../../../libs/mathBlogBase.js"></script>
  <script type="text/javascript" src="../../../libs/mathBlogArticle.js"></script> 
  <script type="text/x-mathjax-config">
    configureMathJax();
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script>  
</head>

<body>
  <div id="menu"></div>

  <div class="mainText">
    <div class="article" date="2 October 2019">
<h3>Stirling+Fedoruk</h3>
<i>I deduce standard Stirling formula using Ted
Vornov's comments on Fedoruk paper</i><br><br>    

<tt>See this file better written (with correction of mistakes) in the Blog for June 2020</tt><br><br>
   
    This is standard that  $
n!=\int_0^\infty t^ne^{-t}dt=
\int_0^\infty e^{-t+n\log t}dt$.

To use stationary phase method consider substitution
  $t=n(1+x)$ (The point $t=-n$ is stationary point, 
  we consider $t=n(1+x)$ not just $t=1+x$ to have 
  'big coefficient' in a vicinity of  stationary point)

      Thus we have:
           $$
	  N!=\int_0^\infty t^Ne^{-t}dt=
\int_0^\infty e^{-t+N\log t}dt=
\int_{-1}^\infty e^{-N(1+x)+
N\log\left[N\left(1+x\right)\right] }Ndx=
	   $$
       $$
\int_{-1}^\infty e^{-n(1+x)+n\log (n(1+x))}ndx=
e^{-n}n^{n+1}\int_{-1}^\infty e^{-n\left(
\log(1+x)-x\right)}dx=
         $$
$$
n\left(n\over e\right)^n\int_{-1}^\infty e^{-n
   \left(
  {x^2\over 2 }
- {x^3\over 6 }
 +{x^4\over 24 }+\dots
   \right)}dx=
n\left(n\over e\right)^n
\int e^{-n{x^2\over 2}}
     e^{
      n
     \left(
- {x^3\over 6 }
 +{x^4\over 24 }+\dots
     \right)
 }dx\,.
 \tag{2}
      $$

Now  we use that
      $
  \sqrt {2\pi n}e^{-nx^2\over 2}=
\int e^{-k^2\over 2n}e^{ikx}dk
       $ 
and
     $$
\int e^{-n{x^2\over 2}}
      \varphi(x)dx=
{1\over \sqrt {2\pi n}}
\int e^{-k^2\over 2n}e^{ikx}dkdx
\int \varphi (p)e^{ipx}dp=
$$
$$
{1\over \sqrt {2\pi n}}
\int  e^{-k^2\over 2n}e^{ikx}\varphi (p)e^{ipx}dpdkdx=
     $$
        $$  
{2\pi \over \sqrt {2\pi n}}
\int e^{-k^2\over 2n}\delta (k+p)\varphi (p)dpdk
=\int e^{-k^2\over 2n}\varphi (k)dk=
{2\pi \over \sqrt {2\pi n}}
 e^{-{1\over 2n}\left({d\over
dx}\right)^2}\varphi(x)\big\vert_{x=0}
        $$
<div class="footnote-head"> Apply this to eqution (2)</div>
<div class="footnote-body">
In fact here
we used the following
identity (Fedoruk) 
      $$
\int f(x_0-x)u(x)dx=
\int \tilde f(k)
e^{ik(x_0-x)}
\tilde u(p)e^{ipx}dx dk dp=
\int \tilde f(k)
e^{ikx_0}
\tilde u(p)e^{i(p-k)x}dx dk dp
      $$
     $$
\int \tilde f(k)
e^{ikx_0}
\tilde u(p)\delta(p-k) dk dp=
\int \tilde f(k)
e^{ikx_0}
\tilde u(k) dk=
f\left({1\over i}{d\over dx}\right)
      u(x)\big\vert_{x=0}\,.
     $$:
</div>
 $$
n!=
\left(n\over e\right)^n\sqrt {2\pi n}
\int_{-1}^\infty e^{-n
   \left(
  {x^2\over 2 }
- {x^3\over 6 }
 +{x^4\over 24 }+\dots
   \right)}dx=
\left(n\over e\right)^n\sqrt {2\pi n}
\int e^{-n{x^2\over 2}}
     e^{
      n
     \left(
- {x^3\over 6 }
 +{x^4\over 24 }+\dots
     \right)
 }dx=
      $$
      $$
\left(n\over e\right)^n\sqrt {2\pi n}
\int e^{-n{x^2\over 2}}
     e^{
      n
     \left(
- {x^3\over 6 }
 +{x^4\over 24 }+\dots
     \right)
 }=
\left(n\over e\right)^n\sqrt {2\pi n}
\left\{
 e^{-{1\over 2n}\left({1\over i}
 {d\over dx}\right)^2}
    \left[
     e^{
      n
     \left(
- {x^3\over 6 }
 +{x^4\over 24 }+\dots
     \right)
 } 
\right]
\right\}_{x=0}\,.
     $$
... and here the mystery began: since the expression
$    \left[
     e^{
      n
     \left(
- {x^3\over 6 }
 +{x^4\over 24 }+\dots
     \right)
 } 
\right]$ possesses only the terms of the order $\geq 3$
in exponent the last integral possess only terms
which are proportional to $1\over n $!
    $$
\int e^{-{1\over n}\left({d\over dx}\right)^2}
    \left[
     e^{
      n
     \left(
- {x^3\over 6 }
 +{x^4\over 24 }+\dots
     \right)
 } 
\right]dx=
1+{1\over 12 n}+{1\over 288 n^2}+\dots
    $$
Try to show it at least partially:
 $$
n!=
\left(n\over e\right)^n\sqrt {2\pi n}
\left\{
 e^{-{1\over 2n}
  \left(
   {1\over i}
{d\over dx}
    \right)^2
      }
    \left[
     e^{
      n
     \left(
- {x^3\over 6 }
 +{x^4\over 24 }+\dots
     \right)
 } 
\right]
   \right\}_{x=0}=
     $$
    $$
\left(n\over e\right)^n\sqrt {2\pi n}
\left[1
       -
      {1\over 2n}
  \left(
    {1\over i}
{d\over dx}
     \right)^2
     +
    {1\over 2}
  {1\over 4n^2}
  \left(
    {1\over i}
{d\over dx}
     \right)^4
   -
    {1\over 6}
  {1\over 8n^3}
  \left(
    {1\over i}
{d\over dx}
     \right)^6
+
    {1\over 24}
  {1\over 16n^4}
  \left(
    {1\over i}
{d\over dx}
     \right)^8
         +\dots
\right]\,\,
 \hbox {acting on}
     $$
       $$
  \left[
   1+
 n\left(
    {x^3\over 3}
     -
   {x^4\over 4}
     +
 {x^5\over 5}
     -
 {x^6\over 6}
     +
 {x^7\over 7}
     -
 {x^8\over 8}
     +
    \dots
    \right)
    +
     {1\over 2}n^2
 \left(
    {x^3\over 3}
     -
   {x^4\over 4}
     +
 {x^5\over 5}
      +\dots
    \right)^2
      +\dots
   \right]=
       $$
        $$
\left(n\over e\right)^n\sqrt {2\pi n}
\left[1
       +
      {1\over 2n}
    {d^2\over dx^2}
     +
  {1\over 8n^2}
    {d^4\over dx^4}
        +
  {1\over 48n^3}
   {d^6\over dx^6}
        +
   {1\over 384n^4}
   {d^8\over dx^8}
         +\dots
\right]\,\,
 \hbox {acting on}
     $$
       $$
  \left[
   1+
 n\left(
    {x^3\over 3}
     -
   {x^4\over 4}
     +
 {x^5\over 5}
     -
 {x^6\over 6}
     +
 {x^7\over 7}
     -
 {x^8\over 8}
     +
    \dots
    \right)
    +
     {1\over 2}n^2
 \left(
    {x^6\over 9}
     -
   {x^7\over 6}
     +
 {x^8\over 16}
    +
 {2x^8\over 15}
      +\dots
    \right)^2
      +\dots
   \right]
      =
       $$
Contribution is gven by the terms of order
   $4,6$ and $8$. More in detail:
  consider  the action of the terms
   $\left[
  {1\over 2n}\left({1\over i}{d\over dx}\right)^2
    \right]^\lambda$
which act on the monoms
     $$
     F_{p_1}F_{p_2}\dots F_{p_r},
     $$
 where every $F_{p_k}$ is a monom of the order $p_k$,
  ($p_i\geq 3$)  which belong to  the term
     $$
   n\left(
   {x^3\over 3}
    -
   {x^4\over 4}
     +
  {x^5\over 5}
    -
   {x^6\over 6}
    +\dots
   \right)\,.
    $$
The condition that the action
of the operator 
   $\left[
  {1\over 2n}\left({1\over i}{d\over dx}\right)^2
    \right]^\lambda$
on the monom 
$F_{p_1}F_{p_2}\dots F_{p_r}$,
is not zero is the following:
    $$
   2\lambda=p_1+p_2+\dots+p_r\,,
     $$
and the power of $n$ corresponding to this monom is
equal to 
      $$
\left({1\over n}\right)^\lambda \cdot 
   n^r=n^{r-\lambda}\,.
       $$
Use this formula.

First of all note that all $p_i\geq 3$, hence
 $2\lambda\geq 3r$, hence
 $$
r-\lambda\leq r-{3r\over 2}<0\,.
 $$
Thus we have proved that in the expansion of $n!$  the
contribution is given by negative powrts of $n$.
 <br><br>

Now calculate the contribution of power ${1n^k}$
for $k=1,2,3\dots$.
<br><br>
We have that 
      $$
   \cases
{
2\lambda=p_1+\dots+p_r\cr
r-\lambda=-k\cr 
}\,, \quad  (p_i\geq 3)\,.
      $$
Hence
      $$
   \cases
      {
2\lambda=p_1+\dots+p_r\geq 3r\cr
\lambda=r+k\cr
     }\Rightarrow 2r+2k\geq 3r, \,\,{\rm i.e.}\,\,
   r\leq 2k
      $$
Thus we see that
 contribution to terms of order ${1\over n^k}$
is given by  action of
  $\exp{-{1\over n}\left({1\over i}{d\over dx}\right)^2}$
on terms which possess not more than $2k$ monoms
 
<br><br>


I  Calculate contribution to ${1\over n}$, $k=1$:
      $$
   \cases
      {
2\lambda=p_1+\dots+p_r\geq 3r\cr
\lambda=r+1\cr
     }\Rightarrow r=1,2\,.
      $$
   $$
a) r=1\,,
   \cases
      {
2\lambda=p_1\cr
\lambda=r+1=2\cr
     }\,,p_1=4\,,\quad 
b) r=2\,,  \cases
      {
2\lambda=p_1+p_2\geq 3r\cr
\lambda=r+1=3\cr
     }\,,p_1=p_2=3 \,.
   $$
<br><br>

I  Calculate contribution to ${1\over n^2}$, $k=2$:
      $$
   \cases
      {
2\lambda=p_1+\dots+p_r\geq 3r\cr
\lambda=r+2\cr
     }\Rightarrow r=1,2,3,4\,.
      $$
  $$
a) r=1\,,
   \cases
      {
2\lambda=p_1\cr
\lambda=r+2=3\cr
     }\,,p_1=6\,,
      $$
       $$ 
b) r=2\,,  \cases
      {
2\lambda=p_1+p_2\geq 3r\cr
\lambda=r+2=4\cr
     }\,,2\lambda=8,\, p_1=3, p_2=5 \,\, {\rm or}\,\,
p_1=p_2=4\,, 
     $$
 $$ 
c) r=3\,,  \cases
      {
2\lambda=p_1+p_2+p_3\geq 3r\cr
\lambda=r+2=5\cr
     }\,,2\lambda=10\,, p_1=p_2=3, p_3=4\,,
   $$
 $$ 
d) r=4\,,  \cases
      {
2\lambda=p_1+p_2+p_3+p_4\cr
\lambda=r+2=6\cr
     }\,,2\lambda=12\,, p_1=p_2=p_3=p_4=3\,,
   $$

On the base of these considerations calculate $n!$ up to
the terms $1\over n$.
   We have  according previous considerations that

     $$
n!=\exp \left(-{1\over 2n}\left(
            {1\over i}{d\over dx}\right)^2\right)
       \exp\left(n\left({x^3\over 3}-{x^4\over 4}
 +{x^5\over 5}+\dots\right)\right)_{x=0}=
         $$
         $$
\left(n\over e\right)^n\sqrt {2\pi n}
   \left[
     1+
  {1\over 8n^2}
    {d^4\over dx^4}
     \left(
     -n{x^4\over 4}
      \right)+
  {1\over 48n^3}
    {d^6\over dx^6}
     \left(
    +{1\over 2}n^2{x^6\over 9}
      \right)
        +
       \dots
    \right]=
      $$
        $$
        $$


    </div>
  </div>
 </body>
</html>